<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ice="http://www.icesoft.com/icefaces/component"
      xmlns:ace="http://www.icefaces.org/icefaces/components"
      xmlns:h="http://java.sun.com/jsf/html">

    <f:metadata>
        <f:event type="preRenderView" listener="#{login.checkAdministradorEmpresaLogin}"/>
    </f:metadata>

    <body>

        <ui:composition template="./template.xhtml">

            <ui:define name="pageContent">


                <ice:outputText styleClass="infoTitle">USUARIOS REGISTRADOS</ice:outputText>
                <ice:panelGrid >

                    <ice:form>
                        <ice:panelGrid columns="2">
                            <ice:outputLabel>Perfil</ice:outputLabel>
                            <ice:selectOneMenu value="#{usuarioEmpresaBean.model.perfil.prfCodigo}">
                                <f:selectItems value="#{usuarioEmpresaBean.listaPerfiles}" />
                            </ice:selectOneMenu>
                            <ice:outputLabel>RUC:</ice:outputLabel>
                            <ice:inputText value="#{usuarioEmpresaBean.model.usuIdentificacion}" size="30" maxlength="13" />
                            <ice:outputLabel>Nombre:</ice:outputLabel>
                            <ice:inputText value="#{usuarioEmpresaBean.model.usuNombre}" size="30" />
                            <ice:outputLabel>Mail:</ice:outputLabel>
                            <ice:inputText value="#{usuarioEmpresaBean.model.usuMail}" size="30" />
                            <ice:outputLabel>Nick</ice:outputLabel>
                            <ice:inputText value="#{usuarioEmpresaBean.model.usuNick}" size="30" maxlength="13" />
                            <ice:selectBooleanCheckbox value="#{usuarioEmpresaBean.model.usuActivo}" id="chkModel" />
                            <ice:outputLabel for="chkModel">Activo</ice:outputLabel>
                            <ice:panelGrid columns="2">
                                <ice:commandButton image="#{resource['images:nuevo-24.png']}" value="Nuevo" actionListener="#{usuarioEmpresaBean.nuevo}" />
                                <ice:commandButton image="#{resource['images:save-32.png']}" value="Guardar" actionListener="#{usuarioEmpresaBean.guardar}" />
                            </ice:panelGrid>
                        </ice:panelGrid>
                    </ice:form>

                    <ice:panelGrid>
                        <ice:form>
                            <ace:dataTable value="#{usuarioEmpresaBean.listaUsuarios}" var="u" id="tablaUsuariosCli" rows="10" paginatorPosition="bottom"> 
                                
                                <ace:column id="ced" headerText="Cédula"
                                            filterBy="#{u.usuIdentificacion}" filterMatchMode="contains">
                                    <h:outputText id="cedUser" value="#{u.usuIdentificacion}"/>
                                </ace:column>
                                <ace:column id="nomb" headerText="Nombre"
                                            filterBy="#{u.usuNombre}" filterMatchMode="contains">
                                    <h:outputText id="nombUser" value="#{u.usuNombre}"/>
                                </ace:column>
                                <ace:column id="nick" headerText="Nick" 
                                            filterBy="#{u.usuNick}" filterMatchMode="contains">
                                    <h:outputText id="nickUser" value="#{u.usuNick}"/>
                                </ace:column>
                                <ace:column id="perf" headerText="Perfil" 
                                            filterBy="#{u.perfil.prfNombre}" filterMatchMode="contains">
                                    <h:outputText id="perfUser" value="#{u.perfil.prfNombre}"/>
                                </ace:column>
                                <ace:column id="usuac" headerText="Activo"
                                            filterBy="#{u.usuActivo?'SI':'NO'}" filterMatchMode="contains">
                                    <h:outputText id="actUser" value="#{u.usuActivo?'SI':'NO'}"/>
                                </ace:column>
                               
                                <ace:column id="edit">
                                    <ice:commandButton  image="#{resource['images:edit-16.png']}" value="Editar" actionListener="#{usuarioEmpresaBean.editar}">
                                        <f:attribute name="usuCodigo" value="#{u.usuCodigo}" />
                                    </ice:commandButton>                       
                                </ace:column>
                                <ace:column id="elim">
                                    <ice:commandButton image="#{resource['images:delete-16.png']}" value="Eliminar" onclick="conf#{u.usuCodigo}.show();"  />
                                    <ace:confirmationDialog widgetVar="conf#{u.usuCodigo}" modal="true"
                                                            header="Borrar Usuario" message="¿Está seguro de eliminar?"
                                                            width="300" height="150" closable="true" closeOnEscape="true">
                                        <ice:commandButton value="Sí" actionListener="#{usuarioEmpresaBean.eliminar}" onclick="conf#{u.usuCodigo}.hide();">
                                            <f:attribute name="usuCodigo" value="#{u.usuCodigo}" />
                                        </ice:commandButton>
                                        <h:commandButton value="No" onclick="conf#{u.usuCodigo}.hide();" />
                                    </ace:confirmationDialog>
                                </ace:column>
                                
                                <ace:column id="rest">
                                    <ice:commandButton image="#{resource['images:restore.png']}" value="Restablecer" onclick="confr#{u.usuCodigo}.show();"  />
                                    <ace:confirmationDialog widgetVar="confr#{u.usuCodigo}" modal="true"
                                                            header="Restablecer" message="¿Está seguro de restablecer la clave?"
                                                            width="300" height="150" closable="true" closeOnEscape="true">
                                        <ice:commandButton value="Sí" actionListener="#{usuarioEmpresaBean.restablecerClave}" onclick="confr#{u.usuCodigo}.hide();">
                                            <f:attribute name="usuCodigo" value="#{u.usuCodigo}" />
                                        </ice:commandButton>
                                        <h:commandButton value="No" onclick="confr#{u.usuCodigo}.hide();" />
                                    </ace:confirmationDialog>                       
                                </ace:column>

                            </ace:dataTable>
                            <ice:dataPaginator id="dataScroll_24" for="tablaUsuariosCli"
                                               rowsCountVar="rowsCount"
                                               displayedRowsCountVar="displayedRowsCount"
                                               firstRowIndexVar="firstRowIndex"
                                               lastRowIndexVar="lastRowIndex"
                                               pageCountVar="pageCount"
                                               pageIndexVar="pageIndex">
                                <ice:outputFormat
                                    styleClass="standard"
                                    value="{0} usuarios registrados, mostrados {1} usuarios(s), de {2} a {3}. Página {4} / {5}.">
                                    <f:param value="#{rowsCount}"/>
                                    <f:param value="#{displayedRowsCount}"/>
                                    <f:param value="#{firstRowIndex}"/>
                                    <f:param value="#{lastRowIndex}"/>
                                    <f:param value="#{pageIndex}"/>
                                    <f:param value="#{pageCount}"/>
                                </ice:outputFormat>
                            </ice:dataPaginator>
                            
                            <ice:dataPaginator id="dataScroll_34"
                                               for="tablaUsuariosCli"
                                               paginator="true"
                                               fastStep="3"
                                               paginatorMaxPages="4">
                                <f:facet name="first">
                                    <ice:graphicImage
                                        url="../xmlhttp/css/xp/css-images/arrow-first.gif"
                                        style="border:none;"
                                        title="First Page"/>
                                </f:facet>
                                <f:facet name="last">
                                    <ice:graphicImage
                                        url="../xmlhttp/css/xp/css-images/arrow-last.gif"
                                        style="border:none;"
                                        title="Last Page"/>
                                </f:facet>
                                <f:facet name="previous">
                                    <ice:graphicImage
                                        url="../xmlhttp/css/xp/css-images/arrow-previous.gif"
                                        style="border:none;"
                                        title="Previous Page"/>
                                </f:facet>
                                <f:facet name="next">
                                    <ice:graphicImage
                                        url="../xmlhttp/css/xp/css-images/arrow-next.gif"
                                        style="border:none;"
                                        title="Next Page"/>
                                </f:facet>
                                <f:facet name="fastforward">
                                    <ice:graphicImage url="../xmlhttp/css/xp/css-images/arrow-ff.gif"
                                                      style="border:none;"
                                                      title="Fast Forward"/>
                                </f:facet>
                                <f:facet name="fastrewind">
                                    <ice:graphicImage url="../xmlhttp/css/xp/css-images/arrow-fr.gif"
                                                      style="border:none;"
                                                      title="Fast Backwards"/>
                                </f:facet>
                            </ice:dataPaginator>
                        </ice:form>
                    </ice:panelGrid>

                </ice:panelGrid>
            </ui:define>

        </ui:composition>

    </body>
</html>
